<!-- Dennis -->

@page "/booking/ny"
@page "/booking/{Id:guid}"
@page "/booking/{Id:guid}/rediger"

@rendermode InteractiveServer

@using static BellaHair.Presentation.WebUI.Components.Pages.Bookings.BookingForm

@inject NavigationManager NavigationManager;
@inject ISnackbar Snackbar;

@if(_bookingMode == BookingMode.New)
{
	<BookingForm Mode="@_bookingMode" />
}
else if(_bookingMode == BookingMode.View || _bookingMode == BookingMode.Edit)
{
	<BookingForm id="@Id" Mode="@_bookingMode" />
}

@code {
	[Parameter]
	public Guid? Id { get; set; }

	private BookingMode _bookingMode;

	protected override async Task OnInitializedAsync()
	{
		await base.OnInitializedAsync();

		var route = NavigationManager.ToBaseRelativePath(NavigationManager.Uri);

		if (route.EndsWith("/ny")) _bookingMode = BookingMode.New;
		else if (route.EndsWith($"/{Id.ToString()}")) _bookingMode = BookingMode.View;
		else if (route.EndsWith("/rediger")) _bookingMode = BookingMode.Edit;
		else
		{
			Snackbar.Add("Noget gik galt.", Severity.Error);
			NavigationManager.NavigateTo("/bookings");
		}
	}
}
